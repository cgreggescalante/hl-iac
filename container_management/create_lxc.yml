# WORKS
- name: Create LXC Container
  hosts: pve1
  become: yes
  vars:
    ansible_token_secret: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      33306531626462336237336434613862306565653235383063613139376239383362343438326463
      6536326635626263376364353532376335393930303430640a343436393132656364653532356531
      35353164636334633162333437333063336530333836363735343431383439656366613038636135
      3434346361626632660a386562353261656265643338616361316562626138626137353863363039
      65393238303435623761323164613363336664306232643961623066353230656439303031393165
      3634333530353065353662313431353164663435306164653336
  tasks:
    - name: Show the secret
      debug:
        var: ansible_token_secret
    - name: Create LXC Container
      community.general.proxmox:
        node: pve1
        api_user: ansible@pam
        api_token_id: ansible-token
        api_token_secret: "{{ ansible_token_secret }}"
        api_host: pve1
        password: otherpass
        cores: 1
        memory: 1024
        swap: 512
        mounts: {rootfs: local-lvm:8}
        hostname: lxc1
        netif:
          net0: "name=eth0,bridge=vmbr0"
        ostemplate: 'local:vztmpl/ubuntu-20.04-standard_20.04-1_amd64.tar.gz'
